webpackJsonp([7],{Hqjd:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("Dd8w"),o=a.n(n),i=a("TIfe"),l=a("ZlPB"),r={data:function(){return{tableData:[],loading:!0,dialogFormVisible:!1,dialogFormTitle:"新增频道",form:{name:"",summary:"",icon:""},formLabelWidth:"120px",imageUrl:"",qiniuUrl:"",qiniuToken:{},operationType:1,currentPage:1,pageSize:4,count:0}},created:function(){this.getChannel(),this.getQiniuToken()},methods:{clearData:function(){this.form={name:"",summary:"",icon:""},this.imageUrl="",this.dialogFormTitle="新增频道"},handleSizeChange:function(e){console.log("每页 "+e+" 条")},handleCurrentChange:function(e){console.log("当前页: "+e),this.loading=!0,this.currentPage=e,this.getChannel()},getQiniuToken:function(){var e=this;this.http("/api/v1/getToken/getQiniuToken",{}).then(function(t){console.log(t),e.qiniuToken=t.token,e.qiniuToken={token:t.token},e.qiniuUrl=t.url})},getChannel:function(){var e=this,t={pageIndex:this.currentPage,pageSize:this.pageSize},a=o()({token:Object(i.a)()},t);Object(l.c)(a).then(function(t){console.log(t),e.loading=!1,e.tableData=t.data,e.count=t.count})},del:function(e){var t=this;console.log(e),this.$confirm("此操作将永久删除是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(l.b)(e).then(function(e){t.$message({type:"success",message:"删除成功!"}),t.getChannel()})})},edit:function(e){var t=this;console.log(e),this.operationType=2,this.dialogFormTitle="编辑频道",this.dialogFormVisible=!0,Object(l.d)(e).then(function(e){t.form=e.data,t.imageUrl="http://"+e.data.icon})},addChannel:function(){var e=this;console.log(this.form),1===this.operationType?Object(l.a)(this.form).then(function(t){2e4===t.code&&(e.$message.success(t.message),e.dialogFormVisible=!1,e.getChannel())}):Object(l.e)(this.form).then(function(t){2e4===t.code&&(e.$message.success(t.message),e.dialogFormVisible=!1,e.getChannel())})},uploadSuccess:function(e,t){this.imageUrl=URL.createObjectURL(t.raw),this.form.icon=this.qiniuUrl+"/"+e.key},beforeUpload:function(e){var t=e.size/1024/1024<2;return t||this.$message.error("上传头像图片大小不能超过 2MB!"),t}}},s={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"channel"},[a("div",{staticClass:"main"},[a("el-card",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"box-card",attrs:{"element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("频道列表")]),e._v(" "),a("el-button",{staticStyle:{float:"right"},attrs:{type:"success",size:"medium"},on:{click:function(t){e.dialogFormVisible=!0}}},[e._v("增加频道")])],1),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData}},[a("el-table-column",{attrs:{prop:"name",label:"频道名称",width:"180"}}),e._v(" "),a("el-table-column",{attrs:{prop:"icon",label:"频道图标",width:"180"},scopedSlots:e._u([{key:"default",fn:function(e){return[a("img",{attrs:{width:"50px",height:"50px",src:"http://"+e.row.icon,alt:""}})]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"summary",label:"频道简介"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:4},readonly:!0},model:{value:t.row.summary,callback:function(a){e.$set(t.row,"summary",a)},expression:"scope.row.summary"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(a){e.del(t.row.id)}}},[e._v("删除")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){e.edit(t.row.id)}}},[e._v("编辑")])]}}])})],1),e._v(" "),a("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[4,8,12,16],"page-size":100,layout:"total, sizes, prev, pager, next, jumper",total:e.count},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1),e._v(" "),a("el-dialog",{attrs:{title:e.dialogFormTitle,visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t},close:e.clearData}},[a("el-form",{attrs:{model:e.form}},[a("el-form-item",{attrs:{label:"频道名称","label-width":e.formLabelWidth}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"频道简介","label-width":e.formLabelWidth}},[a("el-input",{attrs:{type:"textarea",placeholder:"请输入频道简介",autosize:{minRows:2,maxRows:4}},model:{value:e.form.summary,callback:function(t){e.$set(e.form,"summary",t)},expression:"form.summary"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"频道图标","label-width":e.formLabelWidth}},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:"//upload-z1.qiniup.com/","show-file-list":!1,data:e.qiniuToken,"on-success":e.uploadSuccess,"before-upload":e.beforeUpload}},[e.imageUrl?a("img",{staticClass:"avatar",attrs:{src:e.imageUrl}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.addChannel}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var c=a("VU/8")(r,s,!1,function(e){a("hTqq")},"data-v-218e70c2",null);t.default=c.exports},hTqq:function(e,t,a){var n=a("xTZ1");"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);a("rjj0")("19d8e3a9",n,!0)},xTZ1:function(e,t,a){(e.exports=a("FZ+f")(!1)).push([e.i,"\n.channel[data-v-218e70c2] {\n  padding-left: 40px;\n  padding-top: 50px;\n}\n.channel .main[data-v-218e70c2] {\n    width: 80%;\n}\n.channel .avatar-uploader .el-upload[data-v-218e70c2] {\n    border: 1px dashed #d9d9d9;\n    border-radius: 6px;\n    cursor: pointer;\n    position: relative;\n    overflow: hidden;\n}\n.channel .avatar-uploader .el-upload[data-v-218e70c2]:hover {\n    border-color: #409EFF;\n}\n.channel .avatar-uploader-icon[data-v-218e70c2] {\n    font-size: 28px;\n    color: #8c939d;\n    width: 178px;\n    height: 178px;\n    line-height: 178px;\n    text-align: center;\n    border: 1px dashed #d9d9d9;\n}\n.channel .avatar[data-v-218e70c2] {\n    width: 178px;\n    height: 178px;\n    display: block;\n}\n",""])}});