webpackJsonp([8],{"d+U8":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("Dd8w"),n=a.n(i),l=a("TIfe"),o=a("vLgD");var r=a("ZlPB"),s={data:function(){return{tableData:[],loading:!0,dialogFormVisible:!1,dialogFormTitle:"新增轮播图",form:{title:"",url:"",link:"",channelId:""},formLabelWidth:"120px",imageUrl:"",qiniuUrl:"",qiniuToken:{},operationType:1,currentPage:1,pageSize:4,count:0,channelList:[]}},created:function(){this.getSwiper(),this.getQiniuToken(),this.getChannelList()},methods:{filterChannel:function(e){for(var t=this.channelList,a=0;a<t.length;a++)if(t[a].id===e)return t[a].name},getChannelList:function(){var e=this,t={token:Object(l.a)()};Object(r.c)(t).then(function(t){e.channelList=t.data})},dialogShow:function(){this.dialogFormVisible=!0,this.form={title:"",link:"",url:""},this.imageUrl=""},handleSizeChange:function(e){console.log("每页 "+e+" 条")},handleCurrentChange:function(e){console.log("当前页: "+e),this.loading=!0,this.currentPage=e,this.getSwiper()},getQiniuToken:function(){var e=this;this.http("/api/v1/getToken/getQiniuToken",{}).then(function(t){e.qiniuToken=t.token,e.qiniuToken={token:t.token},e.qiniuUrl=t.url})},getSwiper:function(){var e=this,t={pageIndex:this.currentPage,pageSize:this.pageSize};(function(e){return Object(o.a)({url:"/api/v1/swiper/swiperList",method:"get",params:e})})(n()({token:Object(l.a)()},t)).then(function(t){e.loading=!1,e.tableData=t.data,e.count=t.count})},del:function(e){var t=this;this.$confirm("此操作将永久删除是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){(function(e){return Object(o.a)({url:"/api/v1/swiper/del",method:"get",params:{id:e}})})(e).then(function(e){t.$message({type:"success",message:"删除成功!"}),t.getSwiper()})})},edit:function(e){var t=this;this.operationType=2,this.dialogFormTitle="编辑频道",this.dialogFormVisible=!0,function(e){return Object(o.a)({url:"/api/v1/swiper/getSwiperById",method:"get",params:{id:e}})}(e).then(function(e){t.form=e.data,t.imageUrl="http://"+e.data.url})},addSwiper:function(){var e,t=this;1===this.operationType?(e=this.form,Object(o.a)({url:"/api/v1/swiper/add",method:"POST",data:e})).then(function(e){2e4===e.code&&(t.$message.success(e.message),t.dialogFormVisible=!1,t.getSwiper())}):function(e){return Object(o.a)({url:"/api/v1/swiper/updateSwiper",method:"post",data:e})}(this.form).then(function(e){2e4===e.code&&(t.$message.success(e.message),t.dialogFormVisible=!1,t.getSwiper())}),this.form={title:"",url:"",link:""},this.imageUrl=""},uploadSuccess:function(e,t){this.imageUrl=URL.createObjectURL(t.raw),this.form.url=this.qiniuUrl+"/"+e.key},beforeUpload:function(e){var t=e.size/1024/1024<2;return t||this.$message.error("上传头像图片大小不能超过 2MB!"),t},computed:{}}},c={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"swiper"},[a("div",{staticClass:"main"},[a("el-card",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"box-card",attrs:{"element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("轮播图列表")]),e._v(" "),a("el-button",{staticStyle:{float:"right"},attrs:{type:"success",size:"medium"},on:{click:e.dialogShow}},[e._v("新增轮播图")])],1),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData}},[a("el-table-column",{attrs:{prop:"title",label:"轮播图标题"}}),e._v(" "),a("el-table-column",{attrs:{prop:"url",label:"轮播图"},scopedSlots:e._u([{key:"default",fn:function(e){return[a("img",{attrs:{width:"300",height:"100",src:"http://"+e.row.url,alt:""}})]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"channelId",label:"所属频道"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(e.filterChannel(t.row.channelId))+"\n          ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"link",label:"轮播图链接"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(a){e.del(t.row.id)}}},[e._v("删除")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){e.edit(t.row.id)}}},[e._v("编辑")])]}}])})],1),e._v(" "),a("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[4,8,12,16],"page-size":100,layout:"total, sizes, prev, pager, next, jumper",total:e.count},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1),e._v(" "),a("el-dialog",{attrs:{title:e.dialogFormTitle,visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{attrs:{model:e.form}},[a("el-form-item",{attrs:{label:"轮播图标题","label-width":e.formLabelWidth}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"轮播图链接","label-width":e.formLabelWidth}},[a("el-input",{attrs:{type:"textarea",placeholder:"请输入轮播图链接",autosize:{minRows:2,maxRows:4}},model:{value:e.form.link,callback:function(t){e.$set(e.form,"link",t)},expression:"form.link"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"所属频道","label-width":e.formLabelWidth}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.channelId,callback:function(t){e.$set(e.form,"channelId",t)},expression:"form.channelId"}},e._l(e.channelList,function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.id}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"轮播图图片","label-width":e.formLabelWidth}},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:"//upload-z1.qiniup.com/","show-file-list":!1,data:e.qiniuToken,"on-success":e.uploadSuccess,"before-upload":e.beforeUpload}},[e.imageUrl?a("img",{staticClass:"avatar",attrs:{src:e.imageUrl}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.addSwiper}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var d=a("VU/8")(s,c,!1,function(e){a("euj5")},"data-v-010dc496",null);t.default=d.exports},euj5:function(e,t,a){var i=a("os64");"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);a("rjj0")("39ffae0c",i,!0)},os64:function(e,t,a){(e.exports=a("FZ+f")(!1)).push([e.i,"\n.swiper[data-v-010dc496] {\n  padding-left: 40px;\n  padding-top: 50px;\n}\n.swiper .main[data-v-010dc496] {\n    width: 100%;\n}\n.swiper .avatar-uploader .el-upload[data-v-010dc496] {\n    border: 1px dashed #d9d9d9;\n    border-radius: 6px;\n    cursor: pointer;\n    position: relative;\n    overflow: hidden;\n}\n.swiper .avatar-uploader .el-upload[data-v-010dc496]:hover {\n    border-color: #409EFF;\n}\n.swiper .avatar-uploader-icon[data-v-010dc496] {\n    font-size: 28px;\n    color: #8c939d;\n    width: 178px;\n    height: 178px;\n    line-height: 178px;\n    text-align: center;\n    border: 1px dashed #d9d9d9;\n}\n.swiper .avatar[data-v-010dc496] {\n    width: 178px;\n    height: 178px;\n    display: block;\n}\n",""])}});