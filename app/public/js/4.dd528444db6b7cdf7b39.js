webpackJsonp([4],{PYOY:function(e,t,a){(e.exports=a("FZ+f")(!1)).push([e.i,"\n.video[data-v-5da2a636] {\n  padding-left: 40px;\n  padding-top: 50px;\n}\n.video .main[data-v-5da2a636] {\n    width: 80%;\n}\n.video .avatar-uploader .el-upload[data-v-5da2a636] {\n    border: 1px dashed #d9d9d9;\n    border-radius: 6px;\n    cursor: pointer;\n    position: relative;\n    overflow: hidden;\n}\n.video .avatar-uploader .el-upload[data-v-5da2a636]:hover {\n    border-color: #409EFF;\n}\n.video .avatar-uploader-icon[data-v-5da2a636] {\n    font-size: 28px;\n    color: #8c939d;\n    width: 178px;\n    height: 178px;\n    line-height: 178px;\n    text-align: center;\n    border: 1px dashed #d9d9d9;\n}\n.video .avatar[data-v-5da2a636] {\n    width: 178px;\n    height: 178px;\n    display: block;\n}\n",""])},kRZe:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("Dd8w"),o=a.n(i),l=a("TIfe"),r=a("vLgD");var n=a("nKD6"),s={data:function(){return{activeName:"first",tableData:[],theaterList:[{id:1,name:"家有儿女"},{id:2,name:"沙海"}],loading:!0,dialogFormVisible:!1,dialogFormTitle:"新增视频",form:{name:"",title:"",summary:"",videoCate_id:"",poster:"",video_url:"",actors:"",isVip:"",director:"",clarity:"",is_episode:"",episode_index:null},formLabelWidth:"120px",operationType:1,currentPage:1,pageSize:4,count:0,videoCateList:[],qiniuToken:{},imageUrl:"",qiniuUrl:""}},created:function(){this.getList(),this.getVideoCateList(),this.getQiniuToken()},methods:{changeTab:function(e,t){console.log(e,t)},getQiniuToken:function(){var e=this;this.http("/api/v1/getToken/getQiniuToken",{}).then(function(t){e.qiniuToken=t.token,e.qiniuToken={token:t.token},e.qiniuUrl=t.url})},uploadSuccess:function(e,t){this.imageUrl=URL.createObjectURL(t.raw),this.form.poster="http://"+this.qiniuUrl+"/"+e.key},filterChannel:function(e){for(var t=this.videoCateList,a=0;a<t.length;a++)if(t[a].id===e)return t[a].name},clearData:function(){this.form={name:"",title:"",summary:"",videoCate_id:"",poster:"",video_url:"",actors:"",isVip:"",director:"",clarity:""},this.imageUrl="",this.dialogFormTitle="新增视频",this.operationType=1},getVideoCateList:function(){var e=this,t={token:Object(l.a)()};Object(n.d)(t).then(function(t){e.videoCateList=t.data})},handleSizeChange:function(e){console.log("每页 "+e+" 条")},handleCurrentChange:function(e){console.log("当前页: "+e),this.loading=!0,this.currentPage=e,this.getList()},getList:function(){var e=this,t={pageIndex:this.currentPage,pageSize:this.pageSize};(function(e){return Object(r.a)({url:"/api/v1/video/list",method:"get",params:e})})(o()({token:Object(l.a)()},t)).then(function(t){e.loading=!1,e.tableData=t.data,e.count=t.count})},del:function(e){var t=this;this.$confirm("此操作将永久删除是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){(function(e){return Object(r.a)({url:"/api/v1/video/del",method:"get",params:{id:e}})})(e).then(function(e){t.$message({type:"success",message:"删除成功!"}),t.getList()})})},edit:function(e){var t=this;this.operationType=2,this.dialogFormTitle="编辑视频视频",this.dialogFormVisible=!0,function(e){return Object(r.a)({url:"/api/v1/video/getItemById",method:"get",params:{id:e}})}(e).then(function(e){t.form=e.data,t.imageUrl=e.data.poster})},add:function(){var e,t=this;1===this.operationType?(e=this.form,Object(r.a)({url:"/api/v1/video/add",method:"POST",data:e})).then(function(e){2e4===e.code&&(t.$message.success(e.message),t.dialogFormVisible=!1,t.getList())}):function(e){return Object(r.a)({url:"/api/v1/video/update",method:"post",data:e})}(this.form).then(function(e){2e4===e.code&&(t.$message.success(e.message),t.dialogFormVisible=!1,t.getList())})},beforeUpload:function(e){var t=e.size/1024/1024<2;return t||this.$message.error("上传头像图片大小不能超过 2MB!"),t},uploadVideoSuccess:function(e,t){this.video_url=URL.createObjectURL(t.raw),this.form.video_url="http://"+this.qiniuUrl+"/"+e.key},beforeUploadVideo:function(e){var t="mp4"===e.type,a=e.size/1024/1024<1024;return t||this.$message.error("上传视频格式只能是 MP4 格式!"),a||this.$message.error("上传视频大小不能超过1g!"),a}}},d={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"video"},[a("div",{staticClass:"main"},[a("el-card",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"box-card",attrs:{"element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("视频视频列表")]),e._v(" "),a("el-button",{staticStyle:{float:"right"},attrs:{type:"success",size:"medium"},on:{click:function(t){e.dialogFormVisible=!0}}},[e._v("新增视频")])],1),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData}},[a("el-table-column",{attrs:{prop:"name",label:"视频名称",width:"180"}}),e._v(" "),a("el-table-column",{attrs:{prop:"title",label:"标题",width:"180"}}),e._v(" "),a("el-table-column",{attrs:{prop:"isVip",label:"是否vip专属",width:"180"}}),e._v(" "),a("el-table-column",{attrs:{prop:"videoCate_id",label:"所属类型"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(e.filterChannel(t.row.videoCate_id))+"\n          ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"poster",label:"封面"},scopedSlots:e._u([{key:"default",fn:function(e){return[a("img",{attrs:{width:"150",height:"200",src:e.row.poster,alt:""}})]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"summary",label:"简介"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:4},readonly:!0},model:{value:t.row.summary,callback:function(a){e.$set(t.row,"summary",a)},expression:"scope.row.summary"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(a){e.del(t.row.id)}}},[e._v("删除")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){e.edit(t.row.id)}}},[e._v("编辑")])]}}])})],1),e._v(" "),a("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[4,8,12,16],"page-size":100,layout:"total, sizes, prev, pager, next, jumper",total:e.count},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1),e._v(" "),a("el-dialog",{attrs:{title:e.dialogFormTitle,visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t},close:e.clearData}},[a("el-tabs",{on:{"tab-click":e.changeTab},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-form",{ref:"Videoform",attrs:{model:e.form}},[a("el-form-item",{attrs:{label:"视频名称","label-width":e.formLabelWidth}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"封面标题","label-width":e.formLabelWidth}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"所属类型","label-width":e.formLabelWidth}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.videoCate_id,callback:function(t){e.$set(e.form,"videoCate_id",t)},expression:"form.videoCate_id"}},e._l(e.videoCateList,function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.id}})}))],1),e._v(" "),a("el-form-item",{attrs:{"label-width":e.formLabelWidth,label:"是否多集"}},[a("el-radio-group",{model:{value:e.form.is_episode,callback:function(t){e.$set(e.form,"is_episode",t)},expression:"form.is_episode"}},[a("el-radio",{attrs:{label:1}},[e._v("是")]),e._v(" "),a("el-radio",{attrs:{label:0}},[e._v("否")])],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"视频封面","label-width":e.formLabelWidth}},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:"//upload-z1.qiniup.com/","show-file-list":!1,data:e.qiniuToken,"on-success":e.uploadSuccess,"before-upload":e.beforeUpload}},[e.imageUrl?a("img",{staticClass:"avatar",attrs:{src:e.imageUrl}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),e._v(" "),a("el-form-item",{attrs:{label:"上传视频","label-width":e.formLabelWidth}},[a("el-upload",{staticClass:"upload-demo",attrs:{action:"//upload-z1.qiniup.com/",multiple:"",data:e.qiniuToken,"on-success":e.uploadVideoSuccess,"before-upload":e.beforeUploadVideo,limit:1}},[a("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传")]),e._v(" "),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传MP4文件，且不超过1g")])],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"导演","label-width":e.formLabelWidth}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.form.director,callback:function(t){e.$set(e.form,"director",t)},expression:"form.director"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"演员","label-width":e.formLabelWidth}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.form.actors,callback:function(t){e.$set(e.form,"actors",t)},expression:"form.actors"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"清晰度","label-width":e.formLabelWidth}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.form.clarity,callback:function(t){e.$set(e.form,"clarity",t)},expression:"form.clarity"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"评分","label-width":e.formLabelWidth}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.form.rating,callback:function(t){e.$set(e.form,"rating",t)},expression:"form.rating"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"是否vip专属","label-width":e.formLabelWidth}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.form.isVip,callback:function(t){e.$set(e.form,"isVip",t)},expression:"form.isVip"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"视频简介","label-width":e.formLabelWidth}},[a("el-input",{attrs:{type:"textarea",placeholder:"请输入视频简介",autosize:{minRows:2,maxRows:4}},model:{value:e.form.summary,callback:function(t){e.$set(e.form,"summary",t)},expression:"form.summary"}})],1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.add}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var c=a("VU/8")(s,d,!1,function(e){a("z8VQ")},"data-v-5da2a636",null);t.default=c.exports},nKD6:function(e,t,a){"use strict";t.d=function(e){return Object(i.a)({url:"/api/v1/videoCate/list",method:"get",params:e})},t.a=function(e){return Object(i.a)({url:"/api/v1/videoCate/add",method:"POST",data:e})},t.b=function(e){return Object(i.a)({url:"/api/v1/videoCate/del",method:"get",params:{id:e}})},t.c=function(e){return Object(i.a)({url:"/api/v1/videoCate/getItemById",method:"get",params:{id:e}})},t.e=function(e){return Object(i.a)({url:"/api/v1/videoCate/update",method:"post",data:e})};var i=a("vLgD")},z8VQ:function(e,t,a){var i=a("PYOY");"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);a("rjj0")("a0002af6",i,!0)}});